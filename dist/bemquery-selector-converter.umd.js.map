{"version":3,"file":"bemquery-selector-converter.umd.js","sources":["../src/defaultConfig.js","../src/Converter.js","../src/Selector.js","../src/factory.js"],"sourcesContent":["'use strict';\n\nfunction endsWithModifier( selector, bemConfig ) {\n\tconst regex = new RegExp( `[^${bemConfig.elemSeparator}${bemConfig.modifierSeparator}]+${bemConfig.modifierSeparator}[^${bemConfig.elemSeparator}${bemConfig.modifierSeparator}]+$`,\n\t\t'g' );\n\n\treturn !!selector.match( regex );\n}\n\nfunction getSelectorWithoutModifier( selector, modifierSeparator ) {\n\treturn ` ${selector.substring( selector.lastIndexOf( '.' ), selector.lastIndexOf( modifierSeparator ) )}`;\n}\n\nconst defaultConfig = {\n\tbem: {\n\t\telemSeparator: '__',\n\t\tmodifierSeparator: '_'\n\t},\n\trules: {\n\t\tdefault( token ) {\n\t\t\treturn `.${token}`;\n\t\t},\n\n\t\t' > '( token, config ) {\n\t\t\treturn ` ${config.rules.default( token )}`;\n\t\t},\n\n\t\t' '( token, config, selector ) {\n\t\t\tif ( endsWithModifier( selector, config.bem ) ) {\n\t\t\t\treturn `${getSelectorWithoutModifier( selector, config.bem.modifierSeparator )}${config.bem.elemSeparator}${token}`;\n\t\t\t}\n\n\t\t\treturn `${config.bem.elemSeparator}${token}`;\n\t\t},\n\n\t\t':'( token, config ) {\n\t\t\treturn `${config.bem.modifierSeparator}${token}`;\n\t\t}\n\t}\n};\n\nexport default defaultConfig;\n","'use strict';\n\nimport Selector from './Selector';\nimport defaultConfig from './defaultConfig';\n\nfunction convertToken( tokens, config, selector = '' ) {\n\tconst rules = config.rules;\n\tconst delimeter = tokens.shift();\n\tlet rule;\n\tlet token;\n\n\tif ( !delimeter ) {\n\t\treturn selector;\n\t} else if ( !selector ) {\n\t\ttoken = delimeter;\n\t\trule = rules.default;\n\t} else {\n\t\ttoken = tokens.shift();\n\t\trule = rules[ delimeter ];\n\t}\n\n\tif ( typeof rule !== 'function' ) {\n\t\tthrow new SyntaxError( 'Malformed BEM rule' );\n\t}\n\n\tselector += rule( token, config, selector );\n\n\treturn convertToken( tokens, config, selector );\n}\n\nfunction convert( selector, config ) {\n\tconst rules = Object.keys( config.rules ).filter( ( rule ) => {\n\t\treturn rule !== 'default';\n\t} );\n\tconst splitRule = new RegExp( `(${rules.join( '|' )})`, 'g' );\n\tconst splittedSelector = selector.split( splitRule );\n\n\tselector = convertToken( splittedSelector, config );\n\n\treturn selector;\n}\n\n/** Converter's class*/\nclass Converter {\n\t/**\n\t * Create converter's instance.\n\t *\n\t * @param {Object} [config=defaultConfig] converter's configuration options.\n\t * @class\n\t */\n\tconstructor( config = defaultConfig ) {\n\t\t/**\n\t\t * Converter's configuration\n\t\t *\n\t\t * @property {Object}\n\t\t */\n\t\tthis.config = config;\n\t}\n\n\t/**\n\t * Converts given selector to CSS.\n\t *\n\t * @param {String} selector BEM selector to be converted.\n\t * @return {Selector} Converted selector.\n\t */\n\tconvert( selector ) {\n\t\tconst convertedSelector = convert( selector, this.config );\n\n\t\treturn new Selector( selector, convertedSelector );\n\t}\n\n\t/**\n\t * Get state from given `[class]` attribute contents.\n\t *\n\t * @param {String} className HTML `[class]` attribute.\n\t * @return {String|null} Fetched state.\n\t */\n\tgetStateFromClass( className ) {\n\t\tif ( typeof className !== 'string' ) {\n\t\t\tthrow new TypeError( 'Class must be a string.' );\n\t\t}\n\n\t\tconst bemConfig = this.config.bem;\n\t\tconst regex = new RegExp( `[^${bemConfig.elemSeparator}${bemConfig.modifierSeparator}]+${bemConfig.modifierSeparator}([^${bemConfig.elemSeparator}${bemConfig.modifierSeparator}]+)$` );\n\t\tconst match = className.match( regex );\n\n\t\treturn match ? match[ 1 ] : null;\n\t}\n}\n\nexport default Converter;\n","'use strict';\n\n/** Simple class representing selector */\nclass Selector {\n\t/**\n\t * Creates new Selector instance.\n\t *\n\t * @param {String} BEM BEM version of selector.\n\t * @param {String} CSS CSS version of selector.\n\t */\n\tconstructor( BEM, CSS ) {\n\t\t/**\n\t\t * BEM version of selector.\n\t\t *\n\t\t * @property {String}\n\t\t */\n\t\tthis.BEM = BEM;\n\n\t\t/**\n\t\t * CSS version of selector.\n\t\t *\n\t\t * @property {String}\n\t\t */\n\t\tthis.CSS = CSS;\n\n\t\tObject.freeze( this );\n\t}\n}\n\nexport default Selector;\n","'use strict';\n\nimport Converter from './Converter';\nimport defaultConverterConfig from './defaultConfig';\n\n/**\n * BEM selector converter factory.\n *\n * @param {Object} [converterConfig=defaultConverterConfig] Configuration object that\n * should be passed to the Converter constructor.\n * @return {Converter} Converter's instance.\n */\nfunction factory( converterConfig = defaultConverterConfig ) {\n\tconst converter = new Converter( converterConfig );\n\n\treturn converter;\n}\n\nexport default factory;\n"],"names":["endsWithModifier","selector","bemConfig","regex","RegExp","elemSeparator","modifierSeparator","match","getSelectorWithoutModifier","substring","lastIndexOf","convertToken","tokens","config","rules","delimeter","shift","rule","token","default","SyntaxError","convert","Object","keys","filter","splitRule","join","splittedSelector","split","Selector","constructor","BEM","CSS","freeze","defaultConfig","bem","Converter","convertedSelector","getStateFromClass","className","TypeError","converterConfig","defaultConverterConfig","converter"],"mappings":"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"}